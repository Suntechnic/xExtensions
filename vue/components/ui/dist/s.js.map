{"version":3,"file":"s.js","sources":["../src/selector.js","../src/phoneinput.js"],"sourcesContent":["import {Input} from 'x.vue.mixins';\nimport './selector.css';\n\nexport const Selector = {\n    mixins: [Input],\n    name: 'Selector',\n    props: {\n        options: {},\n        valuekey: {}, // ключ значения в объекте option списка options - если не указан - то ключ в options\n        titlekey: {}, // ключ title\n        name: {}, // имя поля\n        placeholder: {default: ''},\n\n        view_search: {default: true},\n        view_reset: {default: true}\n    },\n    data ()\n\t{\n\t\treturn {\n\t\t\tstate: {\n                search: '',\n                open: false\n            }\n\t\t}\n\t},\n    computed: {\n        structure () {\n            let structure = {\n                options: [],\n                map: {}\n            };\n            \n            for (let i in this.options) {\n                let option = {\n                    value: this.valuekey?this.options[i][this.valuekey]:i,\n                    title: this.titlekey?this.options[i][this.titlekey]:this.options[i],\n                    //option: this.options[i]\n                }\n                option.searcheble = option.title.toLowerCase();\n                structure.map[option.value] = structure.options.length;\n                structure.options.push(option);\n            }\n            \n            return structure;\n        },\n        index () {\n            if (this.structure.map) return this.structure.map[this.valueModel];\n        },\n        option () {\n            if (this.structure.options?.length && typeof this.index != 'undefined') return this.structure.options[this.index]\n        },\n        title () {\n            if (this.option) return this.option.title;\n            return this.placeholder;\n        },\n        orderedOptions () {\n            let ordered = [\n                [],\n                [],\n                []\n            ];\n            \n            if (this.state.search) {\n                let search = this.state.search.toLowerCase();\n                for (let i in this.structure.options) {\n                    let option = this.structure.options[i];\n                    let pos = option.searcheble.indexOf(search)\n                    if (pos == 0) {\n                        ordered[0].push(option);\n                    } else if (pos > 0) {\n                        ordered[1].push(option);\n                    } else {\n                        ordered[2].push(option);\n                    }\n                }\n            } else {\n                ordered[0] = this.structure.options;\n            }\n            \n            return ordered;\n        }\n    },\n    methods: {\n        open ()\n        {\n            this.state.open = true;\n        },\n        close ()\n        {\n            this.state.open = false;\n        },\n        toggle ()\n        {\n            this.state.open = !this.state.open;\n        },\n        set (value)\n        {\n            this.valueModel = value;\n            this.close();\n        }\n    },\n\ttemplate: `\n    <div class=\"selector\">\n        <input\n                v-if=\"name\"\n                v-bind:name=\"name\"\n                v-bind:value=\"valueModel\"\n                type=\"hidden\"\n            >\n        <div class=\"selector-display\" v-on:click=\"toggle\">{{title}}</div>\n        <div class=\"selector-list\" v-if=\"state.open\">\n            <input v-if=\"view_search && option\" v-model=\"state.search\">\n            <span class=\"selector-unselect\" v-if=\"view_reset && option\" v-on:click=\"set('')\">Сбросить значение ❌</span>\n            <ul>\n                <li\n                        v-for=\"option in orderedOptions[0]\"\n                        v-bind:key=\"'o_'+option.value\"\n                        v-on:click=\"set(option.value)\"\n                        v-bind:class=\"{active:valueModel==option.value}\"\n                    >{{option.title}}</li>\n                <li\n                        v-for=\"option in orderedOptions[1]\"\n                        v-bind:key=\"'o_'+option.value\"\n                        v-on:click=\"set(option.value)\"\n                        v-bind:class=\"{active:valueModel==option.value}\"\n                        class=\"selector-list-item_others\"\n                    >{{option.title}}</li>\n                <li\n                        v-for=\"option in orderedOptions[2]\"\n                        v-bind:key=\"'o_'+option.value\"\n                        v-on:click=\"set(option.value)\"\n                        v-bind:class=\"{active:valueModel==option.value}\"\n                        class=\"selector-list-item_rest\"\n                    >{{option.title}}</li>\n            </ul>\n        </div>\n    </div>\n\t`\n}","import {Input,InputContented} from 'x.vue.mixins';\n\nexport const PhoneInput = {\n\tmixins: [Input,InputContented],\n\tprops: {\n\t\tname: {\n            type: String,\n\t\t\tdefault: ''\n        },\n        placeholder: {\n            type: String,\n\t\t\tdefault: ''\n        },\n\t\terror: {}\n\t},\n\tcomputed: {\n\t\ttitleDisplaed ()\n\t\t{\n\t\t\treturn this.title; // this.hasContented?this.title:'+7 (901) 234-56-78';\n\t\t}\n\t},\n    methods: {\n        format (val)\n        {\n\t\t\t\n\t\t\tif (val == ''\n\t\t\t\t\t|| val == '+7 '\n\t\t\t\t\t|| val == '+7'\n\t\t\t\t\t|| val == '+'\n\t\t\t\t) return val;\n\t\t\t\n            var emit = false;\n\t\t\tval = val\n\t\t\t\t\t.replace( /\\D/g, '' ) // убираем все нечилас\n\t\t\t\t\t.slice(0,11) // обрезаем до 11 цифр\n\t\t\t\t\t.split( /(?=.)/ ); // преобразуем в массив\n\t\t\tif (val[0] != 7) val[0] = 7; // Заменяем первую цифру на 7\n\t\t\tif (val.length == 11) emit = true; // если цифр 11 поднимаем флаг эммиссии\n\t\t\t\n\t\t\t// форматирование\n\t\t\tvar i = val.length - 1;\n\t\t\tif ( 0 <= i ) val.splice( 1, 0, ' (' );\n\t\t\tif ( 4 <= i ) val.splice( 5, 0, ') ' );\n\t\t\tif ( 7 <= i ) val.splice( 9, 0, '-' );\n\t\t\tif ( 9 <= i ) val.splice( 12, 0, '-' );\n\n\t\t\t// подоготовка\n\t\t\tvar val = '+'+val.join('');\n\t\t\t\n\t\t\treturn val;\n        }\n    },\n\twatch: {\n\t\tvalueModel (val,oval)\n        {\n            if (typeof val != 'string') {\n                this.valueModel = '';\n                return;\n            }\n            \n            let formatVal = this.format(val);\n            if (val != formatVal) {\n                this.valueModel = formatVal;\n                return;\n            }\n            \n            if (this.modelValue != val) this.$emit('update:modelValue', val);\n        },\n\t},\n\ttemplate: `\n    <span>\n        <input\n\t\t\t\ttype=\"text\"\n\t\t\t\tv-model=\"valueModel\"\n\t\t\t\tv-bind:name=\"name\"\n                v-bind:placeholder=\"placeholder\"\n\t\t\t\tref=\"input\"\n\t\t\t>\n    </span>\n\t`\n}\n"],"names":["Selector","mixins","Input","name","props","options","valuekey","titlekey","placeholder","view_search","view_reset","data","state","search","open","computed","structure","map","i","option","value","title","searcheble","toLowerCase","length","push","index","valueModel","_this$structure$optio","orderedOptions","ordered","pos","indexOf","methods","close","toggle","set","template","PhoneInput","InputContented","type","String","error","titleDisplaed","format","val","replace","slice","split","emit","splice","join","watch","oval","formatVal","modelValue","$emit"],"mappings":"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"}