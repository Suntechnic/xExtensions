{"version":3,"file":"s.js","sources":["../src/subscribe.js"],"sourcesContent":["import {MixinBxApi} from 'x.vue.mixins.bx.api';\n\nexport const MixinBxFormSubscribe = {\n    mixins: [MixinBxApi],\n\tprops: {\n        email: { // email, если получен - будет выведен как  email по умолчанию\n\t\t\ttype: String,\n\t\t\trequired: true,\n            default: ''\n\t\t},\n        apiPoints: { // список необходимых именованных точек api проекта\n\t\t\trequired: true,\n            default: {\n                    add: 'subscribe/add' // куда отправлять запрос на добавление\n                }\n\t\t}\n\t},\n\tdata ()\n\t{\n\t\treturn {\n\t\t\tform: {\n\t\t\t\temail: ''\n\t\t\t},\n            state: {\n                exchange: 0,\n                sended: 0\n            }\n\t\t}\n\t},\n\tcomputed: {\n        \n    },\n    created()\n\t{\n\t\tthis.form.email = this.email;\n\t},\n\tmethods: {\n        ////////////////////////////////////////////////////////////////////////\n        // абстрактные методы //////////////////////////////////////////////////\n        success (Response) {\n            let response = JSON.parse(Response);\n            console.log(response);\n        },\n        fail (Response) {\n            let response = JSON.parse(Response);\n            console.log(response);\n        },\n        // абстрактные методы //////////////////////////////////////////////////\n        ////////////////////////////////////////////////////////////////////////\n        $_success (Response) {\n            let response = JSON.parse(Response);\n            \n            if (response.errors?.length) {\n                // вывод ошибок должен быть реализован в реализации компонента\n            } else if (response.data?.code == 0) { // все хорошо\n                this.state.sended = this.state.sended + 1\n            }\n            \n            this.success(Response);\n            this.state.exchange = this.state.exchange-1;\n        },\n        $_fail (Response) {\n            let response = JSON.parse(Response);\n            \n            \n            this.fail(Response);\n            this.state.exchange = this.state.exchange-1;\n        },\n\t\tsend ()\n\t\t{\n            let data = {\n                    email: this.form.email,\n                    sessid: BX.bitrix_sessid()\n                };\n\n            this.state.exchange = this.state.exchange+1;\n\n            BX.ajax.post(\n                    this.apiPointsUrl.add,\n                    data,\n                    this.$_success,\n                    this.$_fail\n                );\n                    \n\t\t}\n\t}\n}\n"],"names":["MixinBxFormSubscribe","mixins","MixinBxApi","props","email","type","String","required","apiPoints","add","data","form","state","exchange","sended","computed","created","methods","success","Response","response","JSON","parse","console","log","fail","$_success","errors","length","code","$_fail","send","sessid","BX","bitrix_sessid","ajax","post","apiPointsUrl"],"mappings":";;;;;;;QAEaA,oBAAoB,GAAG;MAChCC,MAAM,EAAE,CAACC,8BAAU,CAAC;MACvBC,KAAK,EAAE;QACAC,KAAK,EAAE;;UACZC,IAAI,EAAEC,MAAM;UACZC,QAAQ,EAAE,IAAI;UACL,WAAS;SAClB;QACKC,SAAS,EAAE;;UAChBD,QAAQ,EAAE,IAAI;UACL,WAAS;YACDE,GAAG,EAAE,eAAe;;;OAGtC;MACDC,IAAI,kBACJ;QACC,OAAO;UACNC,IAAI,EAAE;YACLP,KAAK,EAAE;WACP;UACQQ,KAAK,EAAE;YACHC,QAAQ,EAAE,CAAC;YACXC,MAAM,EAAE;;SAErB;OACD;MACDC,QAAQ,EAAE,EAEN;MACDC,OAAO,qBACV;QACC,IAAI,CAACL,IAAI,CAACP,KAAK,GAAG,IAAI,CAACA,KAAK;OAC5B;MACDa,OAAO,EAAE;;;QAGFC,OAAO,mBAAEC,QAAQ,EAAE;UACf,IAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACH,QAAQ,CAAC;UACnCI,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAAC;SACxB;QACDK,IAAI,gBAAEN,QAAQ,EAAE;UACZ,IAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACH,QAAQ,CAAC;UACnCI,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAAC;SACxB;;;QAGDM,SAAS,qBAAEP,QAAQ,EAAE;UAAA;UACjB,IAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACH,QAAQ,CAAC;UAEnC,wBAAIC,QAAQ,CAACO,MAAM,6CAAf,iBAAiBC,MAAM,EAAE,CAE5B,MAAM,IAAI,mBAAAR,QAAQ,CAACV,IAAI,mDAAb,eAAemB,IAAI,KAAI,CAAC,EAAE;;YACjC,IAAI,CAACjB,KAAK,CAACE,MAAM,GAAG,IAAI,CAACF,KAAK,CAACE,MAAM,GAAG,CAAC;;UAG7C,IAAI,CAACI,OAAO,CAACC,QAAQ,CAAC;UACtB,IAAI,CAACP,KAAK,CAACC,QAAQ,GAAG,IAAI,CAACD,KAAK,CAACC,QAAQ,GAAC,CAAC;SAC9C;QACDiB,MAAM,kBAAEX,QAAQ,EAAE;UACd,IAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACH,QAAQ,CAAC;UAGnC,IAAI,CAACM,IAAI,CAACN,QAAQ,CAAC;UACnB,IAAI,CAACP,KAAK,CAACC,QAAQ,GAAG,IAAI,CAACD,KAAK,CAACC,QAAQ,GAAC,CAAC;SAC9C;QACPkB,IAAI,kBACJ;UACU,IAAIrB,IAAI,GAAG;YACHN,KAAK,EAAE,IAAI,CAACO,IAAI,CAACP,KAAK;YACtB4B,MAAM,EAAEC,EAAE,CAACC,aAAa;WAC3B;UAEL,IAAI,CAACtB,KAAK,CAACC,QAAQ,GAAG,IAAI,CAACD,KAAK,CAACC,QAAQ,GAAC,CAAC;UAE3CoB,EAAE,CAACE,IAAI,CAACC,IAAI,CACJ,IAAI,CAACC,YAAY,CAAC5B,GAAG,EACrBC,IAAI,EACJ,IAAI,CAACgB,SAAS,EACd,IAAI,CAACI,MAAM,CACd;;;IAIjB,CAAC;;;;;;;;"}